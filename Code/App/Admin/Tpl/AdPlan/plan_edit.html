<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title></title>
<link type="text/css" href="STATIC_URL/admin/css/admin.css" rel="stylesheet" />
<script type="text/javascript" src="STATIC_URL/admin/js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="STATIC_URL/admin/js/formvalidator.js"></script>
<script type="text/javascript" src="STATIC_URL/admin/js/formvalidatorregex.js"></script>
<script type="text/javascript" src="STATIC_URL/admin/js/calendar.js"></script>
<link href="STATIC_URL/admin/css/calendar-blue.css" rel="stylesheet" type="text/css">


</head>
<body>

 <div class="main">
   <div class="body_title">修改计划</div>
		<div class="listmain">
		
<form method="post" action="SITE_URL?m=AdPlan&a=plan_save&"  enctype="multipart/form-data">
<input type="hidden" name="id" value="{$AdPlanInfo['id']}" />
<table align="center" class="list" width="95%" cellspacing="0">
    <tr>
    	<td style="width:120px"><em class="red">*</em>计划名称：</td>
    	<td class="textbox_td">
    		<input class="newsite_textw160" type="text" name="plan_name" value="{$AdPlanInfo['plan_name']}" />
    		<div class="onShow">请填写正确的计划名称，计划名称不能为空</div>					
    	</td>
    </tr>
    <tr>
    	<td style="width:120px"><em class="red">*</em>广告主UID：</td>
    	<td class="textbox_td">
    		<input class="" type="text" name="uid" value="{$AdPlanInfo['uid']}" />
    		<div class="onShow">请填写正确的广告主UID，广告主UID不能为空</div>				
    	</td>
    </tr>
    <tr>
    	<td><em class="red">*</em>接入网址：</td>
    	<td class="textbox_td">
    	    <input class="newsite_textw160" type="text" name="track_url" value="{$AdPlanInfo['track_url']}" />
    	    <div class="onShow">跳转的入口地址，方便记录访问信息</div>	
    	</td>
    </tr>
    <tr>
    	<td><em class="red">*</em>目标网址：</td>
    	<td class="textbox_td">
    	    <input class="newsite_textw160" type="text" name="jump_url" value="{$AdPlanInfo['jump_url']}" />
    	    <div class="onShow">请填写正确的目标网址 ，目标网址不能为空</div>	
    	</td>
    </tr>
	<tr>
	    <td class="w155"><em class="red">*</em>LOGO：</td>
		<td class="textbox_td">
		    <input class="newsite_textw160" type="file" name="plan_logo" />
		    <img src="UPLOAD_URL/{$AdPlanInfo['plan_logo']}" width="120" height="45" title="原LOGO" /> 留空则保留原LOGO
		</td>
	</tr>	
    <tr>
		<td><em class="red">*</em>行业类别：</td>
		<td class="textbox_td">
		    <select name="category_id">
		    	<volist name="industryInfo" id="vo" >
		    		<option value="{$vo.id}"  <if condition="$vo['id'] eq $AdPlanInfo['category_id']">selected="selected"</if> >{$vo.name}</option>
		    	</volist>		   
		     </select>	
		</td>
	 </tr>	
	 <tr>
		<td><em class="red">*</em>计费形式：</td>
		<td class="textbox_td">
			<select class="newsite_select" name="pay_type">
			<option <if condition="$AdPlanInfo['pay_type'] eq 1">selected="selected"</if> value="1">cps</option>
			<option <if condition="$AdPlanInfo['pay_type'] eq 2">selected="selected"</if> value="2">cpa</option>
			<option <if condition="$AdPlanInfo['pay_type'] eq 3">selected="selected"</if> value="3">cpc</option>
			<option <if condition="$AdPlanInfo['pay_type'] eq 4">selected="selected"</if> value="4">cpm</option> 
			</select>
		</td>
	</tr>
	<tr>
		<td><em class="red">*</em>审核方式：</td>
		<td>
		    <input type="radio" <if condition="$AdPlanInfo['plan_check'] eq 0 ">checked="checked"</if> name="plan_check" value="0">无需审核 
		    <input type="radio" <if condition="$AdPlanInfo['plan_check'] eq 1 ">checked="checked"</if> name="plan_check" value="1">手动审核 
		    <input type="radio" <if condition="$AdPlanInfo['plan_check'] eq 2 ">checked="checked"</if> name="plan_check" value="2">自动审核 		
		</td>
	</tr>
	<tbody id="plan_check_tbody" style="display:none">
	<tr>
	   <td>自动审核条件</td>
	   <td>
	       <span style="margin-right:15px">网站主联盟等级不低于：<input type="text" name="plan_check_level" style="width:30px" value="0" /></span>
	       	       <span style="margin-right:15px">PR不低于：<input type="text" name="plan_check_pr" style="width:30px" value="0" /></span>
	       	       
	       	       <span style="margin-right:15px">ALEXA排名不低于：<input type="text" name="plan_check_alexa" style="width:100px" value="0" /></span>
	       	       
	       	       <span style="margin-right:15px">百度指数不低于：<input type="text" name="plan_check_baidu" style="width:30px" value="0" /></span>
	       	   </td>
	</tr>
	</tbody>
	<tr>
		<td><em class="red">*</em>结算周期：</td>
		<td class="textbox_td">
		    <input type="radio" name="clearing_form" <if condition="$AdPlanInfo['clearing_form'] eq  1">checked="checked"</if>value="1">日结 
		    <input type="radio" name="clearing_form" <if condition="$AdPlanInfo['clearing_form'] eq  2">checked="checked"</if>value="2">周结 
		    <input type="radio" name="clearing_form" <if condition="$AdPlanInfo['clearing_form'] eq  3">checked="checked"</if> value="3">月结 						
		</td>
	</tr>
    <tr>
    	<td><em class="red">*</em>计划周期：</td>
    	<td class="textbox_td">
    		开始时间：<input type="text" name="start_date" id="start_date" class="input_text" size="12" value="2013-12-09" />
    		<script>
                    Calendar.setup({
                        inputField     :    "start_date",
                        ifFormat       :    "%Y-%m-%d",
                    });
             </script>
             - 结束时间：<input type="text" name="end_date" id="end_date" class="input_text" size="12" value="2013-12-30" />
    		<script>
                    Calendar.setup({
                        inputField     :    "end_date",
                        ifFormat       :    "%Y-%m-%d",
                    });
             </script>
             <div class="onShow">请填写计划周期的开始时间、结束时间，计划周期时间不能为空</div>	
    	</td>
    </tr>	
    <tbody id="cps" class="price" >
			  <tr>
			      <td class="w155"><em class="red">*</em>数据返回机制：</td>
			      <td class="textbox_td">
			          <input type="radio" name="cps_data_return" value="0" onclick="returnDate1('cps')" <if condition="$AdPlanInfo['cps_data_return'] eq 0">checked="checked"</if>  />实时返回
			          <input type="radio" name="cps_data_return" value="{$AdPlanInfo['cps_data_return']}" onclick="returnDate2('cps')" <if condition="$AdPlanInfo['cps_data_return'] neq 0">checked="checked"</if> />延时返回
			          
			          <span <if condition="$AdPlanInfo['cps_data_return'] eq 0">style="display:none"</if>id="cps_return_date_span">
			              延时 <input type="text" name="cps_data_return" style="width:20px" value="{$AdPlanInfo['cps_data_return']}" /> 天
			          </span>
			      </td>
			  </tr>
			  <tr>
			      <td class="w155"><em class="red">*</em>效果认定期：</td>
			      <td class="textbox_td">
			          <input type="text" name="cps_return_day" style="width:30px" value="{$AdPlanInfo['cps_return_day']}" /> 天
			          <div class="onShow">请填写正确的效果认定期，填写内容必须为数字</div>	
			      </td>
			  </tr>
			  <tr>
				<td class="w155"><em class="red">*</em>费用设置：</td>
				<td class="textbox_td">
					<table style="width:99%;margin:5px auto;text-align:center" id="price_area">
					    <tr style="height:27px"><th><em class="red">*</em>类目标识</th><th><em class="red">*</em>类目名称</th><th><em class="red">*</em>佣金比率</th><th>佣金说明</th><th>操作</th></tr>
					    					    <tr class="cps_price_tr">					        
					        <td><input type="text" name="cps_category_id[]" value="sdf" /></td>
					        <td><input type="text" name="cps_category_name[]" value="sdfd" /></td>
					        <td><input type="text" name="cps_real_price[]" style="width:30px" value="2.00" /> %</td>
					        <td><input type="text" name="cps_remark[]" value="" /></td>
					        <td>
					            <input type="hidden" name="is_step[]" value="0" />
					            <a class="add_price">添加一项 </a>|
					            <a class="add_step">阶梯价格</a>|
					            <a class="remove_price">移除</a>
					        </td>					    
					    </tr>
					    					    					</table>
				</td>
			  </tr>	
			  </tbody>	
			  
			  
			  <tbody id="cpa" class="price" style="display:none">
			  <tr>
			      <td class="w155"><em class="red">*</em>数据返回机制：</td>
			      <td class="textbox_td">
			          <input type="radio" name="cpa_data_return" value="0" onclick="returnDate1('cpa')" checked="checked" />实时返回
			          <input type="radio" name="cpa_data_return" value="1" onclick="returnDate2('cpa')"  />延时返回
			          <span style="display:none" id="cpa_return_date_span">
			              延时 <input type="text" name="cpa_data_return" style="width:20px" value="0"  value="0" /> 天
			          </span>
			      </td>
			  </tr>
			  <tr>
			      <td class="w155"><em class="red">*</em>效果认定期：</td>
			      <td class="textbox_td">
			          <input type="text" name="cpa_return_day" style="width:30px" value="32" /> 天
			      </td>
			  </tr>
			  <tr>
				<td class="w155"><em class="red">*</em>价格：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="cpa_price" value="0.00" />	
				</td>
			  </tr>	
			  <tr>
				<td class="w155"><em class="red">*</em>价格描述：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="cpa_price_desc" value="2%" />	
				</td>
			  </tr>	
			  </tbody>
			  
			  
			  <tbody id="cpm" class="price" style="display:none">
			  <tr>
				<td class="w155"><em class="red">*</em>千次价格：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="cpm_price" value="0.00" />	
				</td>
			  </tr>	
			  <tr>
				<td class="w155">每日pv限额：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="max_per_day" value="0" /> 0为不限制
				</td>
			  </tr>	
			  <tr>
				<td class="w155">单站pv限额：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="max_per_site" value="0" /> 0为不限制
				</td>
			  </tr>
			  </tbody>
			  
			  <tbody id="cpc" class="price" style="display:none">
			  <tr>
				<td class="w155"><em class="red">*</em>价格：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="cpc_price" value="0.00" />	
				</td>
			  </tr>			  
			  <tr>
				<td class="w155">单日点击限额：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="max_per_day" value="0" /> 0为不限制
				</td>
			  </tr>	
			 <tr>
				<td class="w155">单站点击限额：</td>
				<td class="textbox_td">
					<input class="newsite_textw160" type="text" name="max_per_site" value="0" /> 0为不限制
				</td>
			  </tr>
			  </tbody>
			  			  	  			  			  		  
			  <tr>
				<td class="newsite_w155">计划介绍：</td>
				<td class="textbox_td">
					<textarea rows="5" cols="50" class="site_about" name="description">{$AdPlanInfo['description']}</textarea>
				</td>
			  </tr>
			  
			  <tbody>
        <tr>
            <td colspan="2" style="background-color:#fdf9f1;">定向投放</td>
        </tr>
        <tr>
            <td>网站类型定向：</td>
			<td class="textbox_td">
			<input type="radio" checked="checked" name="directional_site_type" value="0">否 <input type="radio" name="directional_site_type" value="1">是 	 
			</td>
		</tr>
		<tbody id="directional_site_type_tbody" style="display:none">
		<tr>
		  <td>
		  </td>
		  <td>
		      <table class="none_border" style="width:100%;">
		          <tr>
		              <td>
		                  <input type="checkbox" name="directional_site_type_check_all" /> 全选
		              </td>
		          </tr>
		          <tr>             
		          		              <td>
		                  <input type="checkbox" name="directional_site_type_arr[]" value="13"  /> 电商		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_site_type_arr[]" value="14"  /> 博客		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_site_type_arr[]" value="15"  /> 论坛		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_site_type_arr[]" value="16"  /> 新闻		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_site_type_arr[]" value="17"  /> 门户网站		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_site_type_arr[]" value="63"  /> 资讯		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_site_type_arr[]" value="64"  /> wjika		              </td>
		          		          </tr>
			 </table>
		  </td>
		</tr>
		</tbody>
		<tr>
            <td>地区定向：</td>
			<td class="textbox_td">
			<input type="radio" checked="checked" name="directional_area" value="0">否 <input type="radio" name="directional_area" value="1">是 	
			</td>
		</tr>
		<tr>
            <td>星期定向：</td>
			<td class="textbox_td">
			<input type="radio" checked="checked" name="directional_week" value="0">否 <input type="radio" name="directional_week" value="1">是 	
			</td>
		</tr>
		<tbody id="directional_week_tbody" style="display:none">
		<tr>
		  <td></td>
		  <td>
		      <table class="none_border" style="width:100%;">
		          <tr>
		              <td>
		                  <input type="checkbox" name="directional_week_check_all" /> 全选
		              </td>
		          </tr>
		          <tr>             
		          		              <td>
		                  <input type="checkbox" name="directional_week_arr[]" value="1" /> 星期一		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_week_arr[]" value="2" /> 星期二		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_week_arr[]" value="3" /> 星期三		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_week_arr[]" value="4" /> 星期四		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_week_arr[]" value="5" /> 星期五		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_week_arr[]" value="6" /> 星期六		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_week_arr[]" value="0" /> 星期日		              </td>
		          		          </tr>
			 </table>
		  </td>	  
		</tr>
		</tbody>
		<tr>
            <td>时间定向：</td>
			<td class="textbox_td">
			<input type="radio" checked="checked" name="directional_time" value="0">否 <input type="radio" name="directional_time" value="1">是 	
			</td>
		</tr>
		<tbody id="directional_time_tbody" style="display:none">
		  <tr>
		      <td></td>
		      <td>
		          <table class="none_border" style="width:100%;">
		          <tr>
		              <td>
		                  <input type="checkbox" name="directional_time_check_all" /> 全选
		              </td>
		          </tr>
		          <tr>             
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="0" /> 0:00 - 0:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="1" /> 1:00 - 1:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="2" /> 2:00 - 2:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="3" /> 3:00 - 3:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="4" /> 4:00 - 4:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="5" /> 5:00 - 5:59
		              </td>
		          		              	</tr><tr>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="6" /> 6:00 - 6:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="7" /> 7:00 - 7:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="8" /> 8:00 - 8:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="9" /> 9:00 - 9:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="10" /> 10:00 - 10:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="11" /> 11:00 - 11:59
		              </td>
		          		              	</tr><tr>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="12" /> 12:00 - 12:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="13" /> 13:00 - 13:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="14" /> 14:00 - 14:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="15" /> 15:00 - 15:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="16" /> 16:00 - 16:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="17" /> 17:00 - 17:59
		              </td>
		          		              	</tr><tr>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="18" /> 18:00 - 18:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="19" /> 19:00 - 19:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="20" /> 20:00 - 20:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="21" /> 21:00 - 21:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="22" /> 22:00 - 22:59
		              </td>
		          		              <td>
		                  <input type="checkbox" name="directional_time_arr[]" value="23" /> 23:00 - 23:59
		              </td>
		          		          </tr>
			     </table>
		      </td>
		  </tr>
		</tbody>
</table>

<script>
//### PAY TYPE		  
$("select[name='pay_type']").change(
		function(){
			var pay_type = $(this).val();
			$(".price").hide();
			$("#"+pay_type).show();
		}
);

// ### PLAN CHECK
$("input[name='plan_check']").change(function(){
	if ($(this).val() == '自动审核'){
		$("#plan_check_tbody").show();
	} else {
		$("#plan_check_tbody").hide();
	}
});

//add cps price
var price_html = '<tr class="cps_price_tr" style="background-color:#eee">';
	price_html += '<td style="width:20%"><input type="text" name="cps_category_id[]" /></td>';
	price_html += '<td style="width:20%"><input type="text" name="cps_category_name[]" /></td>';
	price_html += '<td style="width:20%"><input type="text" name="cps_real_price[]" style="width:50px" /> %</td>';
	price_html += '<td style="width:20%"><input type="text" name="cps_remark[]" /></td>';
	price_html += '<td style="width:20%">';
	price_html += '<input type="hidden" name="is_step[]" value="0" />';
	price_html += '<a class="add_price">添加一项 </a>|';
	price_html += '<a class="add_step">阶梯价格</a>|';
	price_html += '<a class="remove_price">移除</a>';
	price_html += '</td>';
	price_html += '</tr> ';
$(".add_price").live('click',
	    function(){
		    $(this).parent().parent().parent().append(price_html);
	    }
);

$(".remove_price").live('click',
	    function(){
		    $(this).parent().parent().remove();
	    }
);

function returnDate1(pay_type){
	var span_id = '#'+pay_type+'_return_date_span';
	$(span_id).hide();
	$("input[name='"+pay_type+"_data_return']").val("0");
}

function returnDate2(pay_type){
	var span_id = '#'+pay_type+'_return_date_span';
	$("input[name='"+pay_type+"_data_return']").val("");
	$(span_id).show();
}

// step price TD html
$(".add_step").live('click',
function(){
	var price_index = $(this).parent().parent().index(".cps_price_tr");
	var step_price_html = '<tr><td>阶梯类型：<select name="cps_step_type[' + price_index + '][]"><option value="pv">当日PV</option></td>';
	step_price_html += '<td>起始：<input type="text" name="cps_step_start[' + price_index + '][]" style="width:80px" /></td>';
	step_price_html += '<td>结束：<input type="text" name="cps_step_end[' + price_index + '][]" style="width:80px" /></td>';
	step_price_html += '<td>价格：<input type="text" name="cps_step_real_price[' + price_index + '][]" style="width:80px" />%</td>';
	step_price_html += '<td><a class="remove_step">移除</a></td></tr>';

	$(this).parent().parent().after(step_price_html);
	$(this).parent().parent().prev();
    $(this).prev().prev().val('1');
}
);

$(".remove_step").live('click',
	    function(){
    $(this).parent().parent().remove();
}
);

//###### plan directional #######
//site type
$("input[name='directional_site_type']").change(function(){
	if ($(this).val() == 0){
		$("#directional_site_type_tbody").hide();
	} else {
		$("#directional_site_type_tbody").show();
	}
});

$("input[name='directional_site_type_check_all']").change(function(){
if ($(this).attr("checked") == ""){
	$(this).attr("checked", "");
	    $("input[name='directional_site_type_arr[]']").removeAttr("checked");
} else {
	$(this).attr("checked", "checked");
	    $("input[name='directional_site_type_arr[]']").attr("checked", "checked");
}
});

//time
$("input[name='directional_time']").change(function(){
	if ($(this).val() == 0){
		$("#directional_time_tbody").hide();
	} else {
		$("#directional_time_tbody").show();
	}
});

$("input[name='directional_time_check_all']").change(function(){
if ($(this).attr("checked") == ""){
	$(this).attr("checked", "");
	    $("input[name='directional_time_arr[]']").removeAttr("checked");
} else {
	$(this).attr("checked", "checked");
	    $("input[name='directional_time_arr[]']").attr("checked", "checked");
}
});

//week
$("input[name='directional_week']").change(function(){
	if ($(this).val() == 0){
		$("#directional_week_tbody").hide();
	} else {
		$("#directional_week_tbody").show();
	}
});

$("input[name='directional_week_check_all']").change(function(){
if ($(this).attr("checked") == ""){
	$(this).attr("checked", "");
	    $("input[name='directional_week_arr[]']").removeAttr("checked");
} else {
	$(this).attr("checked", "checked");
	    $("input[name='directional_week_arr[]']").attr("checked", "checked");
}
});

</script>              

<table align="center">
    <tr>
        <td colspan="2" align="center"><input class="confirm_btn" type="submit" value="" />
		<input class="back_btn" type="button" onclick="javascript:history.back(-1);" /></td>
    </tr>
</table>
</form>
</div>
</div>
</body>
</html>